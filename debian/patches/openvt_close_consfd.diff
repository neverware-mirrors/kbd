From: Michael Schutte <michi@debian.org>
Subject: openvt: Donâ€™t close consfd twice
Forwarded: no

consfd stores the file descriptor referring to the console.  In some
cases, this will be one of the stdio fds, which are closed in the child
process.  Avoid closing it again.

---
 src/openvt.c |    3 ++-
 1 files changed, 2 insertions(+), 1 deletions(-)

Index: devel/src/openvt.c
===================================================================
--- devel.orig/src/openvt.c	2011-07-22 19:06:52.000000000 +0200
+++ devel/src/openvt.c	2011-07-22 19:07:09.000000000 +0200
@@ -385,7 +385,8 @@
 		close(0);
 		close(1);
 		close(2);
-		close(consfd);
+		if (consfd > 2)
+			close(consfd);
 
 		if ((dup2(fd, 0) == -1) || (dup2(fd, 1) == -1) || (dup2(fd, 2) == -1))
 			openvt_fatal(1, errno, "dup");
